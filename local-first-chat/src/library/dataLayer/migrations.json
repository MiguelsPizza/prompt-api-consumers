[{"sql":["CREATE TABLE \"conversation_messages\" (\n\t\"id\" uuid PRIMARY KEY NOT NULL,\n\t\"conversation_id\" uuid NOT NULL,\n\t\"position\" integer NOT NULL,\n\t\"role\" text NOT NULL,\n\t\"content\" text NOT NULL,\n\t\"temperature_at_creation\" real NOT NULL,\n\t\"top_k_at_creation\" real NOT NULL,\n\t\"user_id\" uuid NOT NULL,\n\t\"created_at\" timestamp with time zone DEFAULT (now() AT TIME ZONE 'utc'::text) NOT NULL,\n\t\"updated_at\" timestamp with time zone DEFAULT (now() AT TIME ZONE 'utc'::text) NOT NULL\n);\n","\nCREATE TABLE \"conversations\" (\n\t\"id\" uuid PRIMARY KEY NOT NULL,\n\t\"name\" text NOT NULL,\n\t\"conversation_summary\" text,\n\t\"system_prompt\" text DEFAULT '' NOT NULL,\n\t\"top_k\" real NOT NULL,\n\t\"temperature\" real NOT NULL,\n\t\"user_id\" uuid NOT NULL,\n\t\"created_at\" timestamp with time zone DEFAULT (now() AT TIME ZONE 'utc'::text) NOT NULL,\n\t\"updated_at\" timestamp with time zone DEFAULT (now() AT TIME ZONE 'utc'::text) NOT NULL\n);\n","\nCREATE TABLE \"organization_memberships\" (\n\t\"id\" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,\n\t\"user_id\" text NOT NULL,\n\t\"organization_id\" text NOT NULL,\n\t\"role\" text NOT NULL,\n\t\"created_at\" timestamp with time zone DEFAULT (now() AT TIME ZONE 'utc'::text) NOT NULL,\n\t\"updated_at\" timestamp with time zone DEFAULT (now() AT TIME ZONE 'utc'::text) NOT NULL\n);\n","\nCREATE TABLE \"organizations\" (\n\t\"id\" text PRIMARY KEY NOT NULL,\n\t\"name\" text NOT NULL,\n\t\"slug\" text NOT NULL,\n\t\"created_by_id\" text,\n\t\"created_at\" timestamp with time zone DEFAULT (now() AT TIME ZONE 'utc'::text) NOT NULL,\n\t\"updated_at\" timestamp with time zone DEFAULT (now() AT TIME ZONE 'utc'::text) NOT NULL\n);\n","\nCREATE TABLE \"users\" (\n\t\"id\" text PRIMARY KEY NOT NULL,\n\t\"first_name\" text,\n\t\"last_name\" text,\n\t\"email\" text,\n\t\"username\" text,\n\t\"last_sign_in_at\" timestamp,\n\t\"created_at\" timestamp with time zone DEFAULT (now() AT TIME ZONE 'utc'::text) NOT NULL,\n\t\"updated_at\" timestamp with time zone DEFAULT (now() AT TIME ZONE 'utc'::text) NOT NULL\n);\n","\nALTER TABLE \"conversation_messages\" ADD CONSTRAINT \"conversation_messages_conversation_id_conversations_id_fk\" FOREIGN KEY (\"conversation_id\") REFERENCES \"public\".\"conversations\"(\"id\") ON DELETE cascade ON UPDATE no action;","\nALTER TABLE \"organization_memberships\" ADD CONSTRAINT \"organization_memberships_user_id_users_id_fk\" FOREIGN KEY (\"user_id\") REFERENCES \"public\".\"users\"(\"id\") ON DELETE no action ON UPDATE no action;","\nALTER TABLE \"organization_memberships\" ADD CONSTRAINT \"organization_memberships_organization_id_organizations_id_fk\" FOREIGN KEY (\"organization_id\") REFERENCES \"public\".\"organizations\"(\"id\") ON DELETE no action ON UPDATE no action;","\nALTER TABLE \"organizations\" ADD CONSTRAINT \"organizations_created_by_id_users_id_fk\" FOREIGN KEY (\"created_by_id\") REFERENCES \"public\".\"users\"(\"id\") ON DELETE no action ON UPDATE no action;","\nCREATE INDEX \"idx_messages_conversation\" ON \"conversation_messages\" USING btree (\"conversation_id\");","\nCREATE INDEX \"idx_messages_position\" ON \"conversation_messages\" USING btree (\"position\");","\nCREATE INDEX \"idx_messages_conv_position\" ON \"conversation_messages\" USING btree (\"conversation_id\",\"position\");","\nCREATE INDEX \"idx_messages_created\" ON \"conversation_messages\" USING btree (\"created_at\");","\nCREATE INDEX \"idx_conversations_updated\" ON \"conversations\" USING btree (\"updated_at\");","\nCREATE INDEX \"unique_membership\" ON \"organization_memberships\" USING btree (\"user_id\",\"organization_id\");"],"bps":true,"folderMillis":1735436811845,"hash":"0b5e19a28b7ded6e5fa2e27738f8283afc98eaa1a3e22f9ea8c3459d6b1a3a1a"},{"sql":["ALTER TABLE \"conversation_messages\" ALTER COLUMN \"user_id\" SET DATA TYPE text;","\nALTER TABLE \"conversations\" ALTER COLUMN \"user_id\" SET DATA TYPE text;","\nALTER TABLE \"conversation_messages\" ADD COLUMN \"soft_deleted\" boolean DEFAULT false NOT NULL;","\nALTER TABLE \"conversation_messages\" ADD COLUMN \"deleted_at\" timestamp with time zone;","\nALTER TABLE \"conversations\" ADD COLUMN \"soft_deleted\" boolean DEFAULT false NOT NULL;","\nALTER TABLE \"conversations\" ADD COLUMN \"deleted_at\" timestamp with time zone;","\nALTER TABLE \"organization_memberships\" ADD COLUMN \"deleted_at\" timestamp with time zone;","\nALTER TABLE \"organizations\" ADD COLUMN \"deleted_at\" timestamp with time zone;","\nALTER TABLE \"users\" ADD COLUMN \"deleted_at\" timestamp with time zone;","\nALTER TABLE \"conversation_messages\" ADD CONSTRAINT \"conversation_messages_user_id_users_id_fk\" FOREIGN KEY (\"user_id\") REFERENCES \"public\".\"users\"(\"id\") ON DELETE no action ON UPDATE no action;","\nALTER TABLE \"conversations\" ADD CONSTRAINT \"conversations_user_id_users_id_fk\" FOREIGN KEY (\"user_id\") REFERENCES \"public\".\"users\"(\"id\") ON DELETE cascade ON UPDATE no action;","\nCREATE INDEX \"idx_messages_soft_deleted\" ON \"conversation_messages\" USING btree (\"soft_deleted\");","\nCREATE INDEX \"idx_conversations_deleted\" ON \"conversations\" USING btree (\"deleted_at\");","\nCREATE INDEX \"idx_conversations_user\" ON \"conversations\" USING btree (\"user_id\");","\nCREATE INDEX \"idx_conversations_soft_deleted\" ON \"conversations\" USING btree (\"soft_deleted\");"],"bps":true,"folderMillis":1735437539828,"hash":"bca6d6faca7ed85bbfce88abd66d1d7249a63d9e21d34148391d1fdb4aa3bd95"},{"sql":["ALTER TABLE \"conversations\" ALTER COLUMN \"system_prompt\" DROP NOT NULL;"],"bps":true,"folderMillis":1735438239842,"hash":"86da8668ac4205a04159eab9708b710c6fd80c38c0912ad51f3a4ff4b71d08cb"}]